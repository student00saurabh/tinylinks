<% layout("/layouts/boilerplate") -%>

<div class="container mx-auto max-w-2xl mt-16 mb-16 p-6 rounded-lg shadow-lg bg-white border
            dark:bg-gray-800 dark:border-gray-700">
  <h1 class="text-2xl font-bold text-gray-800 text-center mb-6
             dark:text-gray-200">ğŸ”§ System Dashboard</h1>

  <div class="space-y-6">

    <!-- Health Check Card -->
    <div class="p-5 border rounded-lg bg-gray-50 shadow-md
                dark:bg-gray-700 dark:border-gray-600 dark:shadow-gray-900/20">
      <h2 class="text-xl font-semibold text-gray-700 mb-2
                 dark:text-gray-200">Server Health Status</h2>
      <p class="text-sm text-gray-500
                dark:text-gray-300">Click the button below to check if the TinyLinks server is working properly.</p>

      <button id="checkHealthBtn"
        class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition
               dark:bg-blue-500 dark:hover:bg-blue-600">
        ğŸš‘ Check Health
      </button>

      <!-- Response Box -->
      <div id="healthResponse" class="mt-4 p-3 rounded-md hidden
                                      dark:text-gray-100 dark:border-gray-500"></div>
    </div>

  </div>
</div>

<script>
  document.getElementById("checkHealthBtn").addEventListener("click", async () => {
    const responseBox = document.getElementById("healthResponse");
    responseBox.classList.remove("hidden");
    responseBox.innerHTML = "â³ Checking...";
    responseBox.className = "mt-4 p-3 rounded-md bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-100";

    try {
      const res = await fetch("/healthz");
      const data = await res.json();

      responseBox.innerHTML = `
        <strong>Status:</strong> ${data.status} <br>
        <strong>Message:</strong> ${data.message} <br>
        <strong>Timestamp:</strong> ${data.timestamp}
      `;
      responseBox.className = "mt-4 p-3 rounded-md bg-green-100 border border-green-400 text-green-800 dark:bg-green-700 dark:border-green-500 dark:text-green-200";
    } catch (error) {
      responseBox.innerHTML = "âŒ Unable to contact server.";
      responseBox.className = "mt-4 p-3 rounded-md bg-red-100 border border-red-400 text-red-800 dark:bg-red-700 dark:border-red-500 dark:text-red-200";
    }
  });
</script>
